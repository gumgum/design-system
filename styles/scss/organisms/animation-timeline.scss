.gds-anim-timeline {
    width: 100%;
    border-collapse: collapse;
    border-spacing: 0px !important;
    margin: ($unit * 3) 0;
}

.gds-anim-timeline__row {
    display: flex;
    flex-direction: row;
    border-bottom: 1px solid $gg-light-2;

    &:first-child {
        border-top: 1px solid $gg-light-2;

        .gds-anim-timeline__cell--stage:before { display: none; }
    }
}

.gds-anim-timeline__cell--asset {
    display: flex;
    flex-direction: row;
}

.gds-anim-timeline__cell--stage {
    display: flex;
    flex-direction: column;
    flex: 1;
    border-right: 1px solid $gg-light-2;

    &:before {
        content: '';
        position: absolute;
        top: -1px;
        left: 0;
        right: 0;
        height: 1px;
        background-color: white;
    }
}

.gds-anim-timeline__color-cap {
    display: inline-block;
    width: ($unit * 0.4);

    &:before {
        content: '';
        position: absolute;
        top: -1px;
        left: 0;
        right: 0;
        height: 1px;
        background-color: white;
    }

    &:first-child:before { display: none; }
}

.gds-anim-timeline__asset-preview {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: ($unit / 2);
    border-right: 1px solid $gg-light-2;
}

.gds-anim-timeline__label {
    width: ($unit * 7);
    @extend .gds-form-group__label;
    @extend .-ellipsis;
    @extend .-m-a-0;
}

.gds-anim-timeline__form-group {
    @extend .gds-form-group;
    @extend .gds-flex;
    @extend .-m-b-0;
    align-items: center;
    border-bottom: 1px solid $gg-light-2;
    padding: ($unit / 2);

    &:only-child,
    &:last-child {
        border-bottom: none;
    }
    &:first-child:nth-last-of-type(2) > .gds-anim-timeline__input-group {
        top: -12px;
    }
    &:first-child:nth-last-of-type(2) ~ :last-child > * {
        top: 12px;
    }
}

.gds-anim-timeline__input-group {
    width: ($unit * 11);
    @extend .gds-form-group__input-group;
}

.gds-anim-timeline__select-input {
    @extend .gds-form-group__select-input;
    @extend .gds-form-group__select-input--sm;
    @extend .gds-form-group__select-input--right-edge;
}

.gds-anim-timeline__button {
    height: 37px;
}

.gds-anim-timeline__button--remove {
    @extend .gds-button;
    @extend .gds-button--sm;
    @extend .gds-button--primary;
    @extend .gds-form-group__input-group-addon;
    margin: 0;
}

.gds-anim-timeline__button--add {
    @extend .gds-button;
    @extend .gds-button--sm;
    @extend .gds-button--default;
    @extend .-color-bg-white;
    @extend .-m-b-0;
    @extend .-m-l-2;
}

.gds-anim-timeline__asset-avatar {
    display: flex;
    justify-content: center;
    align-items: center;
    width: ($unit * 7);
    height: ($unit * 7);
    padding: ($unit / 2);
    @extend .gds-html-preview;
    @extend .gds-html-preview--active;
}

.gds-anim-timeline__asset-image {
    max-width: 100%;
    max-height: 100%;
    height: auto;
}

.gds-anim-timeline__asset-animations {
    display: flex;
    flex-direction: column;
    justify-content: center;
    border-right: 1px solid $gg-light-2;
}

.gds-anim-timeline__section {
    display: flex;
    flex-direction: column;
    justify-content: center;
    flex: 1;
    border-bottom: 1px solid white;

    &:last-of-type { border-bottom: none; }
}

.gds-anim-timeline__bar {
    height: ($unit * 2);
    background-image: url("data:image/svg+xml;utf8,%3Csvg%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20xmlns%3Aa%3D%22http%3A%2F%2Fns.adobe.com%2FAdobeSVGViewerExtensions%2F3.0%2F%22%20x%3D%220px%22%20y%3D%220px%22%20width%3D%2240px%22%20height%3D%2220px%22%20viewBox%3D%220%200%2040%2020%22%20style%3D%22enable-background%3Anew%200%200%2040%2020%3B%22%20xml%3Aspace%3D%22preserve%22%3E%3Cstyle%20type%3D%22text%2Fcss%22%3E.st0%7Bopacity%3A0.1%3Bfill%3A%23FFFFFF%3B%7D%3C%2Fstyle%3E%3Cpolygon%20class%3D%22st0%22%20points%3D%2220%2C0%200%2C20%2020%2C20%2040%2C0%20%22%2F%3E%3C%2Fsvg%3E");
    background-size: contain;
    cursor: ew-resize;
    &:hover {
        box-shadow:0 0 3px rgba(black,0.25);
        .gds-anim-timeline__bar-handle {
            box-shadow:0 0 3px rgba(black,0.25);
        }
    }
}

.gds-anim-timeline__bar-handle {
    position: absolute;
    top: -($unit / 2);
    bottom: -($unit / 2);
    width: ($unit / 2);
    border-radius: $border-radius;
    @extend .-cursor--grab;

    &:active {
        @extend .-cursor--grabbing;
    }

    &:first-child { left: -1px; }
    &:last-child { right: -1px; }
}

.gds-anim-timeline__bar-line {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 1px;
    background-color: white;
}

// Value markers
.gds-anim-timeline__scale {
    position: absolute;
    left: -1px;
    right: 0;
    height: ($unit * 3);
}

.gds-anim-timeline__value-marker {
    position: absolute;
    width: 1px;
    height: $unit;
    background-color: $gg-light-2;
}

.gds-anim-timeline__value-label {
    position: absolute;
    text-align: center;
    color: $gg-light-2;
    margin-left: -($unit / 2);
}

.gds-anim-timeline__scale--top {
    bottom: 100%;

    .gds-anim-timeline__value-marker {
        bottom: 0;
    }

    .gds-anim-timeline__value-label {
        bottom: 100%;
    }
}

.gds-anim-timeline__scale--bottom {
    top: 100%;

    .gds-anim-timeline__value-marker {
        top: 0;
    }

    .gds-anim-timeline__value-label {
        top: 100%;
    }
}

@mixin defaultShadows($borderColor, $dropShadow, $focusGlow, $hasBorder) {
    @if $hasBorder == "true" {
        box-shadow: inset 0 #{-$cap-size} 0 0 $borderColor,  // Bottom Cap
                    inset 0 0 0 1px $borderColor, // Other Caps
                    0 0 0px 1px rgba($focusGlow,0),  // Focus Ring
                    0 0 0px 0 rgba($dropShadow, 0)  // Drop Shadow
    }
    else {
        box-shadow: inset 0 #{-$cap-size} 0 0 $borderColor,  // Bottom Cap
                    0 0 0px 1px rgba($focusGlow,0),  // Focus Ring
                    0 0 0px 0 rgba($dropShadow, 0)  // Drop Shadow
    }
}
@mixin hoverShadows($borderColor, $dropShadow, $focusGlow, $hasBorder) {
    @if $hasBorder == "true" {
        box-shadow: inset 0 #{-$cap-size * 1.5} 0 0 $borderColor,  // Bottom Cap
                    inset 0 0 0 1px $borderColor, // Other Caps
                    0 0 0px 1px rgba($focusGlow,0),  // Focus Ring
                    0 0 3px 0 rgba($dropShadow, 0.2)  // Drop Shadow
    }
    else {
        box-shadow: inset 0 #{-$cap-size * 1.5} 0 0 $borderColor,  // Bottom Cap
                    0 0 0px 1px rgba($focusGlow,0),  // Focus Ring
                    0 0 3px 0 rgba($dropShadow, 0.2)  // Drop Shadow
    }
}
@mixin hoverFocusShadows($borderColor, $dropShadow, $focusGlow, $hasBorder) {
    @if $hasBorder == "true" {
        box-shadow: inset 0 #{-$cap-size * 1.5} 0 0 $borderColor,  // Bottom Cap
                    inset 0 0 0 1px $borderColor, // Other Caps
                    0 0 1px 1px rgba($focusGlow,1),  // Focus Ring
                    0 0 3px 0 rgba($dropShadow, 0.2)  // Drop Shadow
    }
    else {
        box-shadow: inset 0 #{-$cap-size * 1.5} 0 0 $borderColor,  // Bottom Cap
                    0 0 1px 1px rgba($focusGlow,1),  // Focus Ring
                    0 0 3px 0 rgba($dropShadow, 0.2)  // Drop Shadow
    }
}
@mixin activeShadows($borderColor, $dropShadow, $focusGlow, $hasBorder) {
    @if $hasBorder == "true" {
        box-shadow: inset 0 #{-$cap-size * 0.5} 0 0 $borderColor,  // Bottom Cap
                    inset 0 0 0 1px $borderColor, // Other Caps
                    0 0 0px 1px rgba($focusGlow,0),  // Focus Ring
                    0 0 1px 0 rgba($dropShadow, 0.4)  // Drop Shadow
    }
    else {
        box-shadow: inset 0 #{-$cap-size * 0.5} 0 0 $borderColor,  // Bottom Cap
                    0 0 0px 1px rgba($focusGlow,0),  // Focus Ring
                    0 0 1px 0 rgba($dropShadow, 0.4)  // Drop Shadow
    }
}
@mixin focusShadows($borderColor, $dropShadow, $focusGlow, $hasBorder) {
    @if $hasBorder == "true" {
        box-shadow: inset 0 #{-$cap-size} 0 0 $borderColor,  // Bottom Cap
                    inset 0 0 0 1px $borderColor, // Other Caps
                    0 0 1px 1px rgba($focusGlow,1),  // Focus Ring
                    0 0 0px 0 rgba($dropShadow, 0)  // Drop Shadow
    }
    else {
        box-shadow: inset 0 #{-$cap-size} 0 0 $borderColor,  // Bottom Cap
                    0 0 1px 1px rgba($focusGlow,1),  // Focus Ring
                    0 0 0px 0 rgba($dropShadow, 0)  // Drop Shadow
    }
}


// Row coloration
.gds-anim-timeline__row--darkblue {
    .gds-anim-timeline__color-cap,
    .gds-anim-timeline__bar {
        background-color: $gg-blue-dark-1;
    }

    .gds-anim-timeline__button--add {
        color: $gg-blue-dark-1;
    }

    .gds-anim-timeline__button--remove {
        background-color: $gg-blue-dark-1;
        @include defaultShadows($gg-blue-dark-3, black, $gg-blue, "true");
        &:hover {
            background-color: $gg-blue;

            @include defaultShadows($gg-blue-dark-3, black, $gg-blue, "true");
        }

        &:focus:hover {
            background-color: $gg-blue;
            @include hoverFocusShadows($gg-blue-dark-3, black, $gg-blue, "true");
        }
        &:active,
        &:active:focus {
            @include activeShadows($gg-blue-dark-3, black, $gg-blue, "true");
        }
        &:focus {
            background-color: $gg-blue;
            @include focusShadows($gg-blue-dark-3, black, $gg-blue, "true");
        }

        // &:active,
        // &:focus {
        //     background-color: $gg-blue-dark-3;
        // }
    }

    .gds-anim-timeline__bar {
        border: 1px solid $gg-blue-dark-3;
        &:hover {
            border-color: $gg-blue-dark-2;
            background-color: $gg-blue;
            .gds-anim-timeline__bar-handle {
                background-color: $gg-blue-dark-1;
            }
        }
    }

    .gds-anim-timeline__bar-handle {
        background-color: $gg-blue-dark-2;
        &:hover {
            background-color: $gg-blue-light-2 !important;
        }
        &:active {
            background-color: $gg-blue-light-4 !important;
        }
    }

    .gds-anim-timeline__asset-avatar {
        border-color: $gg-blue-dark-1;
    }

    .gds-anim-timeline__cell--stage {
        background-color: rgba($gg-blue-dark-1, 0.15);
    }
}

.gds-anim-timeline__row--gold {
    .gds-anim-timeline__color-cap,
    .gds-anim-timeline__bar {
        background-color: $gg-gold-dark-1;
    }

    .gds-anim-timeline__button--add {
        color: $gg-gold-dark-1;
    }

    .gds-anim-timeline__button--remove {
        background-color: $gg-gold-dark-1;
        @include defaultShadows($gg-gold-dark-4, black, $gg-gold, "true");
        &:hover {
            background-color: $gg-gold;

            @include defaultShadows($gg-gold-dark-4, black, $gg-gold, "true");
        }

        &:focus:hover {
            background-color: $gg-gold;
            @include hoverFocusShadows($gg-gold-dark-4, black, $gg-gold, "true");
        }
        &:active,
        &:active:focus {
            @include activeShadows($gg-gold-dark-4, black, $gg-gold, "true");
        }
        &:focus {
            background-color: $gg-gold;
            @include focusShadows($gg-gold-dark-4, black, $gg-gold, "true");
        }
    }

    .gds-anim-timeline__bar {
        border: 1px solid $gg-gold-dark-3;
        &:hover {
            border-color: $gg-gold-dark-2;
            background-color: $gg-gold;
            .gds-anim-timeline__bar-handle {
                background-color: $gg-gold-dark-1;
            }
        }
    }

    .gds-anim-timeline__bar-handle {
        background-color: $gg-gold-dark-2;
        &:hover {
            background-color: $gg-gold-light-2 !important;
        }
        &:active {
            background-color: $gg-gold-light-4 !important;
        }
    }

    .gds-anim-timeline__asset-avatar {
        border-color: $gg-gold-dark-1;
    }

    .gds-anim-timeline__cell--stage {
        background-color: rgba($gg-gold-dark-1, 0.15);
    }
}

.gds-anim-timeline__row--green {
    .gds-anim-timeline__color-cap,
    .gds-anim-timeline__bar {
        background-color: $gg-green-dark-1;
    }

    .gds-anim-timeline__button--add {
        color: $gg-green-dark-1;
    }

    .gds-anim-timeline__button--remove {
        background-color: $gg-green-dark-1;
        @include defaultShadows($gg-green-dark-3, black, $gg-green, "true");
        &:hover {
            background-color: $gg-green;

            @include defaultShadows($gg-green-dark-3, black, $gg-green, "true");
        }

        &:focus:hover {
            background-color: $gg-green;
            @include hoverFocusShadows($gg-green-dark-3, black, $gg-green, "true");
        }
        &:active,
        &:active:focus {
            @include activeShadows($gg-green-dark-3, black, $gg-green, "true");
        }
        &:focus {
            background-color: $gg-green;
            @include focusShadows($gg-green-dark-3, black, $gg-green, "true");
        }
    }

    .gds-anim-timeline__bar {
        border: 1px solid $gg-green-dark-3;
        &:hover {
            border-color: $gg-green-dark-2;
            background-color: $gg-green;
            .gds-anim-timeline__bar-handle {
                background-color: $gg-green-dark-1;
            }
        }
    }

    .gds-anim-timeline__bar-handle {
        background-color: $gg-green-dark-2;
        &:hover {
            background-color: $gg-green-light-2 !important;
        }
        &:active {
            background-color: $gg-green-light-4 !important;
        }
    }

    .gds-anim-timeline__asset-avatar {
        border-color: $gg-green-dark-1;
    }

    .gds-anim-timeline__cell--stage {
        background-color: rgba($gg-green-dark-1, 0.15);
    }
}

.gds-anim-timeline__row--red {
    .gds-anim-timeline__color-cap,
    .gds-anim-timeline__bar {
        background-color: $gg-red-dark-1;
    }

    .gds-anim-timeline__button--add {
        color: $gg-red-dark-1;
    }

    .gds-anim-timeline__button--remove {
        background-color: $gg-red-dark-1;
        @include defaultShadows($gg-red-dark-3, black, $gg-red, "true");
        &:hover {
            background-color: $gg-red;

            @include defaultShadows($gg-red-dark-3, black, $gg-red, "true");
        }

        &:focus:hover {
            background-color: $gg-red;
            @include hoverFocusShadows($gg-red-dark-3, black, $gg-red, "true");
        }
        &:active,
        &:active:focus {
            @include activeShadows($gg-red-dark-3, black, $gg-red, "true");
        }
        &:focus {
            background-color: $gg-red;
            @include focusShadows($gg-red-dark-3, black, $gg-red, "true");
        }
    }

    .gds-anim-timeline__bar {
        border: 1px solid $gg-red-dark-3;
        &:hover {
            border-color: $gg-red-dark-2;
            background-color: $gg-red;
            .gds-anim-timeline__bar-handle {
                background-color: $gg-red-dark-1;
            }
        }
    }

    .gds-anim-timeline__bar-handle {
        background-color: $gg-red-dark-2;
        &:hover {
            background-color: $gg-red-light-2 !important;
        }
        &:active {
            background-color: $gg-red-light-4 !important;
        }
    }

    .gds-anim-timeline__asset-avatar {
        border-color: $gg-red-dark-1;
    }

    .gds-anim-timeline__cell--stage {
        background-color: rgba($gg-red-dark-1, 0.15);
    }
}
